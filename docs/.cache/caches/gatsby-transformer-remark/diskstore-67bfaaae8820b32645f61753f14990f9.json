{"expireTime":9007200819376322000,"key":"transformer-remark-markdown-ast-209d5938222544ef14f627378fa41b18-gatsby-remark-autolink-headersgatsby-remark-copy-linked-filesgatsby-remark-prismjsgatsby-remark-check-links-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"Time to accomplish: ","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"12 Minutes","position":{"start":{"line":2,"column":22,"offset":22},"end":{"line":2,"column":32,"offset":32},"indent":[]}}],"position":{"start":{"line":2,"column":21,"offset":21},"end":{"line":2,"column":33,"offset":33},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":33,"offset":33},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"With Warthog Client, updating data from a graph API is as simple as calling a function. Additionally, the Warthog Client cache is smart enough to automatically update in most cases. In this section, we'll learn how to use the ","position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":227,"offset":261},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":4,"column":227,"offset":261},"end":{"line":4,"column":237,"offset":271},"indent":[]}},{"type":"text","value":" component from ","position":{"start":{"line":4,"column":237,"offset":271},"end":{"line":4,"column":253,"offset":287},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">react-warthog</code>","position":{"start":{"line":4,"column":253,"offset":287},"end":{"line":4,"column":268,"offset":302},"indent":[]}},{"type":"text","value":" to login a user.","position":{"start":{"line":4,"column":268,"offset":302},"end":{"line":4,"column":285,"offset":319},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":285,"offset":319},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#what-is-a-mutation-component","title":null,"data":{"hProperties":{"aria-label":"what is a mutation component permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"What is a Mutation component?","position":{"start":{"line":6,"column":4,"offset":324},"end":{"line":6,"column":33,"offset":353},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":321},"end":{"line":6,"column":33,"offset":353},"indent":[]},"data":{"id":"what-is-a-mutation-component","htmlAttributes":{"id":"what-is-a-mutation-component"},"hProperties":{"id":"what-is-a-mutation-component"}}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":8,"column":1,"offset":355},"end":{"line":8,"column":5,"offset":359},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":8,"column":5,"offset":359},"end":{"line":8,"column":15,"offset":369},"indent":[]}},{"type":"text","value":" component is another important building block in an Warthog app. It's a React component that provides a function to execute a GraphQL mutation. Additionally, it tracks the loading, completion, and error state of that mutation.","position":{"start":{"line":8,"column":15,"offset":369},"end":{"line":8,"column":242,"offset":596},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":355},"end":{"line":8,"column":242,"offset":596},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Updating data with a ","position":{"start":{"line":10,"column":1,"offset":598},"end":{"line":10,"column":22,"offset":619},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":10,"column":22,"offset":619},"end":{"line":10,"column":32,"offset":629},"indent":[]}},{"type":"text","value":" component from ","position":{"start":{"line":10,"column":32,"offset":629},"end":{"line":10,"column":48,"offset":645},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">react-warthog</code>","position":{"start":{"line":10,"column":48,"offset":645},"end":{"line":10,"column":63,"offset":660},"indent":[]}},{"type":"text","value":" is very similar to fetching data with a ","position":{"start":{"line":10,"column":63,"offset":660},"end":{"line":10,"column":104,"offset":701},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Query</code>","position":{"start":{"line":10,"column":104,"offset":701},"end":{"line":10,"column":111,"offset":708},"indent":[]}},{"type":"text","value":" component. The main difference is that the first argument to the ","position":{"start":{"line":10,"column":111,"offset":708},"end":{"line":10,"column":177,"offset":774},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":10,"column":177,"offset":774},"end":{"line":10,"column":187,"offset":784},"indent":[]}},{"type":"text","value":" render prop function is a ","position":{"start":{"line":10,"column":187,"offset":784},"end":{"line":10,"column":214,"offset":811},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"mutate function","position":{"start":{"line":10,"column":216,"offset":813},"end":{"line":10,"column":231,"offset":828},"indent":[]}}],"position":{"start":{"line":10,"column":214,"offset":811},"end":{"line":10,"column":233,"offset":830},"indent":[]}},{"type":"text","value":" that actually triggers the mutation when it is called. The second argument to the ","position":{"start":{"line":10,"column":233,"offset":830},"end":{"line":10,"column":316,"offset":913},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":10,"column":316,"offset":913},"end":{"line":10,"column":326,"offset":923},"indent":[]}},{"type":"text","value":" render prop function is a result object that contains loading and error state, as well as the return value from the mutation. Let's see an example:","position":{"start":{"line":10,"column":326,"offset":923},"end":{"line":10,"column":474,"offset":1071},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":598},"end":{"line":10,"column":474,"offset":1071},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#update-data-with-mutation","title":null,"data":{"hProperties":{"aria-label":"update data with mutation permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Update data with Mutation","position":{"start":{"line":12,"column":4,"offset":1076},"end":{"line":12,"column":29,"offset":1101},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":1073},"end":{"line":12,"column":29,"offset":1101},"indent":[]},"data":{"id":"update-data-with-mutation","htmlAttributes":{"id":"update-data-with-mutation"},"hProperties":{"id":"update-data-with-mutation"}}},{"type":"paragraph","children":[{"type":"text","value":"The first step is defining our GraphQL mutation. To start, navigate to ","position":{"start":{"line":14,"column":1,"offset":1103},"end":{"line":14,"column":72,"offset":1174},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">src/pages/login.js</code>","position":{"start":{"line":14,"column":72,"offset":1174},"end":{"line":14,"column":92,"offset":1194},"indent":[]}},{"type":"text","value":" and copy the code below so we can start building out the login screen:","position":{"start":{"line":14,"column":92,"offset":1194},"end":{"line":14,"column":163,"offset":1265},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1103},"end":{"line":14,"column":163,"offset":1265},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"src/pages/login.js","position":{"start":{"line":16,"column":2,"offset":1268},"end":{"line":16,"column":20,"offset":1286},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1267},"end":{"line":16,"column":21,"offset":1287},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1267},"end":{"line":16,"column":21,"offset":1287},"indent":[]}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Mutation<span class=\"token punctuation\">,</span> ApolloConsumer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-warthog'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> gql <span class=\"token keyword\">from</span> <span class=\"token string\">'graphql-tag'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> LoginForm<span class=\"token punctuation\">,</span> Loading <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../components'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">LOGIN_USER</span> <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  mutation login($email: String!) {\n    login(email: $email)\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":18,"column":1,"offset":1289},"end":{"line":30,"column":4,"offset":1560},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Just like before, we're using the ","position":{"start":{"line":32,"column":1,"offset":1562},"end":{"line":32,"column":35,"offset":1596},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gql</code>","position":{"start":{"line":32,"column":35,"offset":1596},"end":{"line":32,"column":40,"offset":1601},"indent":[]}},{"type":"text","value":" function to wrap our GraphQL mutation so it can be parsed into an AST. We're also importing some components that we'll use in the next steps. Now, let's bind this mutation to our component by passing it to the ","position":{"start":{"line":32,"column":40,"offset":1601},"end":{"line":32,"column":251,"offset":1812},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">mutation</code>","position":{"start":{"line":32,"column":251,"offset":1812},"end":{"line":32,"column":261,"offset":1822},"indent":[]}},{"type":"text","value":" prop:","position":{"start":{"line":32,"column":261,"offset":1822},"end":{"line":32,"column":267,"offset":1828},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1562},"end":{"line":32,"column":267,"offset":1828},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"src/pages/login.js","position":{"start":{"line":34,"column":2,"offset":1831},"end":{"line":34,"column":20,"offset":1849},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1830},"end":{"line":34,"column":21,"offset":1850},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1830},"end":{"line":34,"column":21,"offset":1850},"indent":[]}},{"type":"html","lang":"jsx","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mutation</span></span> <span class=\"token attr-name\">mutation</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">LOGIN_USER</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">login<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginForm</span></span> <span class=\"token attr-name\">login</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>login<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Mutation</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":36,"column":1,"offset":1852},"end":{"line":44,"column":4,"offset":2024},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Our ","position":{"start":{"line":46,"column":1,"offset":2026},"end":{"line":46,"column":5,"offset":2030},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":46,"column":5,"offset":2030},"end":{"line":46,"column":15,"offset":2040},"indent":[]}},{"type":"text","value":" component takes a render prop function as a child that exposes a mutate function (","position":{"start":{"line":46,"column":15,"offset":2040},"end":{"line":46,"column":98,"offset":2123},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">login</code>","position":{"start":{"line":46,"column":98,"offset":2123},"end":{"line":46,"column":105,"offset":2130},"indent":[]}},{"type":"text","value":") and the data object returned from the mutation. Finally, we pass our login function to the ","position":{"start":{"line":46,"column":105,"offset":2130},"end":{"line":46,"column":198,"offset":2223},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">LoginForm</code>","position":{"start":{"line":46,"column":198,"offset":2223},"end":{"line":46,"column":209,"offset":2234},"indent":[]}},{"type":"text","value":" component.","position":{"start":{"line":46,"column":209,"offset":2234},"end":{"line":46,"column":220,"offset":2245},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2026},"end":{"line":46,"column":220,"offset":2245},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create a better experience for our users, we want to persist the login between sessions. In order to do that, we need to save our login token to ","position":{"start":{"line":48,"column":1,"offset":2247},"end":{"line":48,"column":149,"offset":2395},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">localStorage</code>","position":{"start":{"line":48,"column":149,"offset":2395},"end":{"line":48,"column":163,"offset":2409},"indent":[]}},{"type":"text","value":". Let's learn how we can use the ","position":{"start":{"line":48,"column":163,"offset":2409},"end":{"line":48,"column":196,"offset":2442},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCompleted</code>","position":{"start":{"line":48,"column":196,"offset":2442},"end":{"line":48,"column":209,"offset":2455},"indent":[]}},{"type":"text","value":" handler on ","position":{"start":{"line":48,"column":209,"offset":2455},"end":{"line":48,"column":221,"offset":2467},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":48,"column":221,"offset":2467},"end":{"line":48,"column":231,"offset":2477},"indent":[]}},{"type":"text","value":" to persist our login:","position":{"start":{"line":48,"column":231,"offset":2477},"end":{"line":48,"column":253,"offset":2499},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2247},"end":{"line":48,"column":253,"offset":2499},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#expose-warthog-client-with-apolloconsumer","title":null,"data":{"hProperties":{"aria-label":"expose warthog client with apolloconsumer permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Expose Warthog Client with ApolloConsumer","position":{"start":{"line":50,"column":5,"offset":2505},"end":{"line":50,"column":46,"offset":2546},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2501},"end":{"line":50,"column":46,"offset":2546},"indent":[]},"data":{"id":"expose-warthog-client-with-apolloconsumer","htmlAttributes":{"id":"expose-warthog-client-with-apolloconsumer"},"hProperties":{"id":"expose-warthog-client-with-apolloconsumer"}}},{"type":"paragraph","children":[{"type":"text","value":"One of the main functions of ","position":{"start":{"line":52,"column":1,"offset":2548},"end":{"line":52,"column":30,"offset":2577},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">react-warthog</code>","position":{"start":{"line":52,"column":30,"offset":2577},"end":{"line":52,"column":45,"offset":2592},"indent":[]}},{"type":"text","value":" is that it puts your ","position":{"start":{"line":52,"column":45,"offset":2592},"end":{"line":52,"column":67,"offset":2614},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">ApolloClient</code>","position":{"start":{"line":52,"column":67,"offset":2614},"end":{"line":52,"column":81,"offset":2628},"indent":[]}},{"type":"text","value":" instance on React's context. Sometimes, we need to access the ","position":{"start":{"line":52,"column":81,"offset":2628},"end":{"line":52,"column":144,"offset":2691},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">ApolloClient</code>","position":{"start":{"line":52,"column":144,"offset":2691},"end":{"line":52,"column":158,"offset":2705},"indent":[]}},{"type":"text","value":" instance to directly call a method that isn't exposed by the ","position":{"start":{"line":52,"column":158,"offset":2705},"end":{"line":52,"column":220,"offset":2767},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">react-warthog</code>","position":{"start":{"line":52,"column":220,"offset":2767},"end":{"line":52,"column":235,"offset":2782},"indent":[]}},{"type":"text","value":" helper components. The ","position":{"start":{"line":52,"column":235,"offset":2782},"end":{"line":52,"column":259,"offset":2806},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">ApolloConsumer</code>","position":{"start":{"line":52,"column":259,"offset":2806},"end":{"line":52,"column":275,"offset":2822},"indent":[]}},{"type":"text","value":" component can help us access the client.","position":{"start":{"line":52,"column":275,"offset":2822},"end":{"line":52,"column":316,"offset":2863},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2548},"end":{"line":52,"column":316,"offset":2863},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">ApolloConsumer</code>","position":{"start":{"line":54,"column":1,"offset":2865},"end":{"line":54,"column":17,"offset":2881},"indent":[]}},{"type":"text","value":" takes a render prop function as a child that is called with the client instance. Let's wrap our ","position":{"start":{"line":54,"column":17,"offset":2881},"end":{"line":54,"column":114,"offset":2978},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":54,"column":114,"offset":2978},"end":{"line":54,"column":124,"offset":2988},"indent":[]}},{"type":"text","value":" component with ","position":{"start":{"line":54,"column":124,"offset":2988},"end":{"line":54,"column":140,"offset":3004},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">ApolloConsumer</code>","position":{"start":{"line":54,"column":140,"offset":3004},"end":{"line":54,"column":156,"offset":3020},"indent":[]}},{"type":"text","value":" to expose the client. Next, we want to pass an ","position":{"start":{"line":54,"column":156,"offset":3020},"end":{"line":54,"column":204,"offset":3068},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCompleted</code>","position":{"start":{"line":54,"column":204,"offset":3068},"end":{"line":54,"column":217,"offset":3081},"indent":[]}},{"type":"text","value":" callback to ","position":{"start":{"line":54,"column":217,"offset":3081},"end":{"line":54,"column":230,"offset":3094},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Mutation</code>","position":{"start":{"line":54,"column":230,"offset":3094},"end":{"line":54,"column":240,"offset":3104},"indent":[]}},{"type":"text","value":" that will be called once the mutation is complete with its return value. This callback is where we will save the login token to ","position":{"start":{"line":54,"column":240,"offset":3104},"end":{"line":54,"column":369,"offset":3233},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">localStorage</code>","position":{"start":{"line":54,"column":369,"offset":3233},"end":{"line":54,"column":383,"offset":3247},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":54,"column":383,"offset":3247},"end":{"line":54,"column":384,"offset":3248},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":2865},"end":{"line":54,"column":384,"offset":3248},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In our ","position":{"start":{"line":56,"column":1,"offset":3250},"end":{"line":56,"column":8,"offset":3257},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCompleted</code>","position":{"start":{"line":56,"column":8,"offset":3257},"end":{"line":56,"column":21,"offset":3270},"indent":[]}},{"type":"text","value":" handler, we also call ","position":{"start":{"line":56,"column":21,"offset":3270},"end":{"line":56,"column":44,"offset":3293},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">client.writeData</code>","position":{"start":{"line":56,"column":44,"offset":3293},"end":{"line":56,"column":62,"offset":3311},"indent":[]}},{"type":"text","value":" to write local data to the Warthog cache indicating that the user is logged in. This is an example of a ","position":{"start":{"line":56,"column":62,"offset":3311},"end":{"line":56,"column":167,"offset":3416},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"direct write","position":{"start":{"line":56,"column":169,"offset":3418},"end":{"line":56,"column":181,"offset":3430},"indent":[]}}],"position":{"start":{"line":56,"column":167,"offset":3416},"end":{"line":56,"column":183,"offset":3432},"indent":[]}},{"type":"text","value":" that we'll explore further in the next section on local state management.","position":{"start":{"line":56,"column":183,"offset":3432},"end":{"line":56,"column":257,"offset":3506},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":3250},"end":{"line":56,"column":257,"offset":3506},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"src/pages/login.js","position":{"start":{"line":58,"column":2,"offset":3509},"end":{"line":58,"column":20,"offset":3527},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":3508},"end":{"line":58,"column":21,"offset":3528},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":3508},"end":{"line":58,"column":21,"offset":3528},"indent":[]}},{"type":"html","lang":"jsx{3,4,7-10,22}","meta":null,"value":"<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ApolloConsumer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">client</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span>        <span class=\"token operator\">&lt;</span>Mutation\n          mutation<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">LOGIN_USER</span><span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">          onCompleted<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> login <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">,</span> login<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">            client<span class=\"token punctuation\">.</span><span class=\"token function\">writeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> isLoggedIn<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>        <span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">login<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> loading<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// this loading state will probably never show, but it's helpful to</span>\n            <span class=\"token comment\">// have for testing</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loading<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Loading</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">An error occurred</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginForm</span></span> <span class=\"token attr-name\">login</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>login<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Mutation</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ApolloConsumer</span></span><span class=\"token punctuation\">></span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":60,"column":1,"offset":3530},"end":{"line":85,"column":4,"offset":4240},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#attach-authorization-headers-to-the-request","title":null,"data":{"hProperties":{"aria-label":"attach authorization headers to the request permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Attach authorization headers to the request","position":{"start":{"line":87,"column":5,"offset":4246},"end":{"line":87,"column":48,"offset":4289},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":4242},"end":{"line":87,"column":48,"offset":4289},"indent":[]},"data":{"id":"attach-authorization-headers-to-the-request","htmlAttributes":{"id":"attach-authorization-headers-to-the-request"},"hProperties":{"id":"attach-authorization-headers-to-the-request"}}},{"type":"paragraph","children":[{"type":"text","value":"We're almost done completing our login feature! Before we do, we need to attach our token to the GraphQL request's headers so our server can authorize the user. To do this, navigate to ","position":{"start":{"line":89,"column":1,"offset":4291},"end":{"line":89,"column":186,"offset":4476},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">src/index.js</code>","position":{"start":{"line":89,"column":186,"offset":4476},"end":{"line":89,"column":200,"offset":4490},"indent":[]}},{"type":"text","value":" where we create our ","position":{"start":{"line":89,"column":200,"offset":4490},"end":{"line":89,"column":221,"offset":4511},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">ApolloClient</code>","position":{"start":{"line":89,"column":221,"offset":4511},"end":{"line":89,"column":235,"offset":4525},"indent":[]}},{"type":"text","value":" and replace the code below for the constructor:","position":{"start":{"line":89,"column":235,"offset":4525},"end":{"line":89,"column":283,"offset":4573},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":4291},"end":{"line":89,"column":283,"offset":4573},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"src/index.js","position":{"start":{"line":91,"column":2,"offset":4576},"end":{"line":91,"column":14,"offset":4588},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":4575},"end":{"line":91,"column":15,"offset":4589},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":4575},"end":{"line":91,"column":15,"offset":4589},"indent":[]}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  cache<span class=\"token punctuation\">,</span>\n  link<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpLink</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    uri<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://localhost:4000/graphql'</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      authorization<span class=\"token punctuation\">:</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ncache<span class=\"token punctuation\">.</span><span class=\"token function\">writeData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    isLoggedIn<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    cartItems<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":93,"column":1,"offset":4591},"end":{"line":110,"column":4,"offset":4934},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Specifying the ","position":{"start":{"line":112,"column":1,"offset":4936},"end":{"line":112,"column":16,"offset":4951},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">headers</code>","position":{"start":{"line":112,"column":16,"offset":4951},"end":{"line":112,"column":25,"offset":4960},"indent":[]}},{"type":"text","value":" option on ","position":{"start":{"line":112,"column":25,"offset":4960},"end":{"line":112,"column":36,"offset":4971},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">HttpLink</code>","position":{"start":{"line":112,"column":36,"offset":4971},"end":{"line":112,"column":46,"offset":4981},"indent":[]}},{"type":"text","value":" allows us to read the token from ","position":{"start":{"line":112,"column":46,"offset":4981},"end":{"line":112,"column":80,"offset":5015},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">localStorage</code>","position":{"start":{"line":112,"column":80,"offset":5015},"end":{"line":112,"column":94,"offset":5029},"indent":[]}},{"type":"text","value":" and attach it to the request's headers each time a GraphQL operation is made.","position":{"start":{"line":112,"column":94,"offset":5029},"end":{"line":112,"column":172,"offset":5107},"indent":[]}}],"position":{"start":{"line":112,"column":1,"offset":4936},"end":{"line":112,"column":172,"offset":5107},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In the next section, we'll add the ","position":{"start":{"line":114,"column":1,"offset":5109},"end":{"line":114,"column":36,"offset":5144},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">&lt;Login&gt;</code>","position":{"start":{"line":114,"column":36,"offset":5144},"end":{"line":114,"column":45,"offset":5153},"indent":[]}},{"type":"text","value":" form to the user interface. For that, we need to learn how Warthog allows us to manage local state in our app.","position":{"start":{"line":114,"column":45,"offset":5153},"end":{"line":114,"column":156,"offset":5264},"indent":[]}}],"position":{"start":{"line":114,"column":1,"offset":5109},"end":{"line":114,"column":156,"offset":5264},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":115,"column":1,"offset":5265}}}}